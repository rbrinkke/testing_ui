{"openapi":"3.1.0","info":{"title":"Notifications API","description":"Real-time notification service with multi-channel delivery (push, email, SMS).\n\nFeatures subscription management, notification preferences, and delivery status tracking.\n\n## Key Features\n- Multi-channel notifications (push/email/SMS)\n- User preference management\n- Delivery status tracking\n- Subscription tiers (free/premium)\n- Template-based notification rendering\n\n## Architecture\n- Database: PostgreSQL with `activity` schema\n- Queue: Redis for async delivery\n- Auth: JWT Bearer + service tokens","version":"1.0.0"},"paths":{"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint.\nReturns 200 if API is healthy, 503 if degraded.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/settings":{"get":{"tags":["settings"],"summary":"Get Settings","description":"Get user's notification settings.\nReturns defaults if settings don't exist yet.","operationId":"get_settings_api_v1_settings_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotificationSettingsResponse"}}}}},"security":[{"HTTPBearer":[]}]},"patch":{"tags":["settings"],"summary":"Update Settings","description":"Update user's notification settings.\nAll fields are optional - only send fields to update.\n\nNote: ghost_mode requires Premium subscription.","operationId":"update_settings_api_v1_settings_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateSettingsRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotificationSettingsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/notifications":{"get":{"tags":["notifications"],"summary":"Get Notifications","description":"Get paginated list of user's notifications.\n\nQuery params:\n    - status: Filter by status (unread, read, archived)\n    - type: Filter by notification type\n    - limit: Page size (1-100, default 20)\n    - offset: Pagination offset (default 0)","operationId":"get_notifications_api_v1_notifications_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/NotificationStatus"},{"type":"null"}],"title":"Status"}},{"name":"type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/NotificationType"},{"type":"null"}],"title":"Type"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotificationListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["notifications"],"summary":"Create Notification","description":"Create new notification (internal service-to-service).\n\nRequires X-Service-Token header.","operationId":"create_notification_api_v1_notifications_post","parameters":[{"name":"x-service-token","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Service-Token"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateNotificationRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateNotificationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/notifications/unread/count":{"get":{"tags":["notifications"],"summary":"Get Unread Count","description":"Get count of unread notifications by type.","operationId":"get_unread_count_api_v1_notifications_unread_count_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnreadCountResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/v1/notifications/{notification_id}":{"get":{"tags":["notifications"],"summary":"Get Notification","description":"Get single notification by ID.","operationId":"get_notification_api_v1_notifications__notification_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"notification_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Notification Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NotificationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["notifications"],"summary":"Delete Notification","description":"Archive or permanently delete notification.\n\nQuery params:\n    - permanent: If true, hard delete. If false (default), archive.","operationId":"delete_notification_api_v1_notifications__notification_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"notification_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Notification Id"}},{"name":"permanent","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Permanent"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/notifications/{notification_id}/read":{"patch":{"tags":["notifications"],"summary":"Mark Notification Read","description":"Mark single notification as read.","operationId":"mark_notification_read_api_v1_notifications__notification_id__read_patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"notification_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Notification Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/notifications/mark-read":{"post":{"tags":["notifications"],"summary":"Mark Notifications Read Bulk","description":"Mark multiple notifications as read (bulk operation).\n\nOptions:\n    1. Provide notification_ids to mark specific notifications\n    2. Set mark_all=true to mark all unread\n    3. Combine mark_all + notification_type to mark all of specific type","operationId":"mark_notifications_read_bulk_api_v1_notifications_mark_read_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MarkReadBulkRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MarkReadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/":{"get":{"summary":"Root","description":"Root endpoint","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ActorInfo":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"username":{"type":"string","title":"Username"},"first_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"First Name"},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name"},"main_photo_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Main Photo Url"}},"type":"object","required":["user_id","username"],"title":"ActorInfo","description":"Actor who triggered the notification"},"CreateNotificationRequest":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"actor_user_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Actor User Id"},"notification_type":{"$ref":"#/components/schemas/NotificationType"},"target_type":{"type":"string","pattern":"^(activity|post|comment|user)$","title":"Target Type"},"target_id":{"type":"string","format":"uuid","title":"Target Id"},"title":{"type":"string","maxLength":255,"title":"Title"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"payload":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Payload"}},"type":"object","required":["user_id","notification_type","target_type","target_id","title"],"title":"CreateNotificationRequest","description":"Create notification request (internal service)"},"CreateNotificationResponse":{"properties":{"notification_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Notification Id"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"},"status":{"type":"string","title":"Status"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}},"type":"object","required":["notification_id","created_at","status"],"title":"CreateNotificationResponse","description":"Create notification response"},"DeleteResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","message"],"title":"DeleteResponse","description":"Delete/archive operation response"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MarkReadBulkRequest":{"properties":{"notification_ids":{"anyOf":[{"items":{"type":"string","format":"uuid"},"type":"array"},{"type":"null"}],"title":"Notification Ids"},"mark_all":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Mark All","default":false},"notification_type":{"anyOf":[{"$ref":"#/components/schemas/NotificationType"},{"type":"null"}]}},"type":"object","title":"MarkReadBulkRequest","description":"Bulk mark-read request"},"MarkReadResponse":{"properties":{"updated_count":{"type":"integer","title":"Updated Count"},"message":{"type":"string","title":"Message"}},"type":"object","required":["updated_count","message"],"title":"MarkReadResponse","description":"Mark-read operation response"},"NotificationListResponse":{"properties":{"notifications":{"items":{"$ref":"#/components/schemas/NotificationResponse"},"type":"array","title":"Notifications"},"pagination":{"$ref":"#/components/schemas/PaginationMeta"}},"type":"object","required":["notifications","pagination"],"title":"NotificationListResponse","description":"Paginated notification list"},"NotificationResponse":{"properties":{"notification_id":{"type":"string","format":"uuid","title":"Notification Id"},"user_id":{"type":"string","format":"uuid","title":"User Id"},"actor":{"anyOf":[{"$ref":"#/components/schemas/ActorInfo"},{"type":"null"}]},"notification_type":{"$ref":"#/components/schemas/NotificationType"},"target_type":{"type":"string","title":"Target Type"},"target_id":{"type":"string","format":"uuid","title":"Target Id"},"title":{"type":"string","title":"Title"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"status":{"$ref":"#/components/schemas/NotificationStatus"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"read_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Read At"},"payload":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Payload"}},"type":"object","required":["notification_id","user_id","notification_type","target_type","target_id","title","status","created_at"],"title":"NotificationResponse","description":"Single notification response"},"NotificationSettingsResponse":{"properties":{"user_id":{"type":"string","format":"uuid","title":"User Id"},"email_notifications":{"type":"boolean","title":"Email Notifications"},"push_notifications":{"type":"boolean","title":"Push Notifications"},"activity_reminders":{"type":"boolean","title":"Activity Reminders"},"community_updates":{"type":"boolean","title":"Community Updates"},"friend_requests":{"type":"boolean","title":"Friend Requests"},"marketing_emails":{"type":"boolean","title":"Marketing Emails"},"ghost_mode":{"type":"boolean","title":"Ghost Mode"},"language":{"type":"string","title":"Language"},"timezone":{"type":"string","title":"Timezone"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At"}},"type":"object","required":["user_id","email_notifications","push_notifications","activity_reminders","community_updates","friend_requests","marketing_emails","ghost_mode","language","timezone"],"title":"NotificationSettingsResponse","description":"User notification settings response"},"NotificationStatus":{"type":"string","enum":["unread","read","archived"],"title":"NotificationStatus","description":"Notification status enum"},"NotificationType":{"type":"string","enum":["activity_invite","activity_reminder","activity_update","community_invite","new_member","new_post","comment","reaction","mention","profile_view","new_favorite","system"],"title":"NotificationType","description":"Notification type enum"},"PaginationMeta":{"properties":{"total":{"type":"integer","title":"Total"},"limit":{"type":"integer","title":"Limit"},"offset":{"type":"integer","title":"Offset"},"has_more":{"type":"boolean","title":"Has More"}},"type":"object","required":["total","limit","offset","has_more"],"title":"PaginationMeta","description":"Pagination metadata"},"UnreadCountResponse":{"properties":{"total_unread":{"type":"integer","title":"Total Unread"},"by_type":{"additionalProperties":{"type":"integer"},"type":"object","title":"By Type"},"note":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Note"}},"type":"object","required":["total_unread","by_type"],"title":"UnreadCountResponse","description":"Unread notification counts by type"},"UpdateSettingsRequest":{"properties":{"email_notifications":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Email Notifications"},"push_notifications":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Push Notifications"},"activity_reminders":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Activity Reminders"},"community_updates":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Community Updates"},"friend_requests":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Friend Requests"},"marketing_emails":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Marketing Emails"},"ghost_mode":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Ghost Mode"},"language":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Language"},"timezone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Timezone"}},"type":"object","title":"UpdateSettingsRequest","description":"Update notification settings (all fields optional)"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"Enter JWT token from auth-api"}}},"security":[{"BearerAuth":[]}]}